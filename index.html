<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Vehicle Rental Payment & Expense Tracker</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 600px; margin: 10px auto; padding: 10px; }
  h1, h2 { text-align: center; }
  label { display: block; margin-top: 15px; }
  input, select, button, textarea { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
  table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 0.9rem; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #f0f0f0; }
  .leave { background-color: #fdd; }
  @media (max-width: 480px) {
    body { padding: 5px; }
    table, th, td { font-size: 0.8rem; }
  }
</style>
</head>
<body>

<h1>Vehicle Rental Payment & Expense Tracker</h1>

<!-- Payment and Attendance Form -->
<form id="paymentForm">
  <label for="date">Date:</label>
  <input type="date" id="date" required />

  <label for="payment">Payment Amount:</label>
  <input type="number" id="payment" min="0" step="0.01" placeholder="Amount received (0 if none)" required />

  <label for="attendance">Driver Attendance:</label>
  <select id="attendance" required>
    <option value="present">Present</option>
    <option value="leave">Leave</option>
  </select>

  <button type="submit">Save Payment Entry</button>
</form>

<h2>Payment Records</h2>
<table id="recordsTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Payment Received</th>
      <th>Driver Attendance</th>
    </tr>
  </thead>
  <tbody></tbody>
  <tfoot>
    <tr>
      <th>Total</th>
      <th id="totalPayment">0</th>
      <th id="totalLeave">0 Leave Days</th>
    </tr>
  </tfoot>
</table>

<!-- Expense Form -->
<form id="expenseForm">
  <h2>Add Expense Given to Driver</h2>
  <label for="expenseDate">Date:</label>
  <input type="date" id="expenseDate" required />

  <label for="expenseAmount">Amount Given:</label>
  <input type="number" id="expenseAmount" min="0" step="0.01" placeholder="Enter amount" required />

  <label for="expenseReason">Reason:</label>
  <textarea id="expenseReason" rows="2" placeholder="Repair, Fuel, etc." required></textarea>

  <button type="submit">Save Expense</button>
</form>

<h2>Expense Records</h2>
<table id="expenseTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Amount Given</th>
      <th>Reason</th>
    </tr>
  </thead>
  <tbody></tbody>
  <tfoot>
    <tr>
      <th>Total</th>
      <th id="totalExpense">0</th>
      <th></th>
    </tr>
  </tfoot>
</table>

<script>
  // Elements for payments
  const paymentForm = document.getElementById('paymentForm');
  const recordsTableBody = document.querySelector('#recordsTable tbody');
  const totalPaymentEl = document.getElementById('totalPayment');
  const totalLeaveEl = document.getElementById('totalLeave');

  // Elements for expenses
  const expenseForm = document.getElementById('expenseForm');
  const expenseTableBody = document.querySelector('#expenseTable tbody');
  const totalExpenseEl = document.getElementById('totalExpense');

  // Load saved records or start new arrays
  let records = JSON.parse(localStorage.getItem('vehicleRecords')) || [];
  let expenses = JSON.parse(localStorage.getItem('vehicleExpenses')) || [];

  // Initialize date fields to today
  const today = new Date().toISOString().slice(0,10);
  document.getElementById('date').value = today;
  document.getElementById('expenseDate').value = today;

  // Render payment records
  function renderRecords() {
    recordsTableBody.innerHTML = '';
    let totalPayment = 0;
    let leaveCount = 0;

    records.sort((a,b) => new Date(b.date) - new Date(a.date));

    for (let record of records) {
      const tr = document.createElement('tr');
      if(record.attendance === 'leave') tr.classList.add('leave');

      tr.innerHTML = `
        <td>${record.date}</td>
        <td>${record.payment.toFixed(2)}</td>
        <td>${record.attendance.charAt(0).toUpperCase() + record.attendance.slice(1)}</td>
      `;
      recordsTableBody.appendChild(tr);

      totalPayment += record.payment;
      if(record.attendance === 'leave') leaveCount++;
    }

    totalPaymentEl.textContent = totalPayment.toFixed(2);
    totalLeaveEl.textContent = `${leaveCount} Leave Days`;
  }

  // Render expense records
  function renderExpenses() {
    expenseTableBody.innerHTML = '';
    let totalExpense = 0;

    expenses.sort((a,b) => new Date(b.date) - new Date(a.date));

    for (let exp of expenses) {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${exp.date}</td>
        <td>${exp.amount.toFixed(2)}</td>
        <td>${exp.reason}</td>
      `;
      expenseTableBody.appendChild(tr);

      totalExpense += exp.amount;
    }

    totalExpenseEl.textContent = totalExpense.toFixed(2);
  }

  // Save payment record
  paymentForm.addEventListener('submit', e => {
    e.preventDefault();

    const date = paymentForm.date.value;
    const payment = parseFloat(paymentForm.payment.value);
    const attendance = paymentForm.attendance.value;

    const existingIndex = records.findIndex(r => r.date === date);
    if(existingIndex >= 0){
      records[existingIndex] = { date, payment, attendance };
    } else {
      records.push({ date, payment, attendance });
    }

    localStorage.setItem('vehicleRecords', JSON.stringify(records));
    renderRecords();
    paymentForm.reset();
    paymentForm.date.value = today;
  });

  // Save expense record
  expenseForm.addEventListener('submit', e => {
    e.preventDefault();

    const date = expenseForm.expenseDate.value;
    const amount = parseFloat(expenseForm.expenseAmount.value);
    const reason = expenseForm.expenseReason.value.trim();

    expenses.push({ date, amount, reason });

    localStorage.setItem('vehicleExpenses', JSON.stringify(expenses));
    renderExpenses();
    expenseForm.reset();
    expenseForm.expenseDate.value = today;
  });

  // Initial rendering
  renderRecords();
  renderExpenses();

</script>

</body>
</html>
